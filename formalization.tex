\section{Calculus}
\label{sec:Calculus}

\section{Safety properties} %propriet√† di sicurezza
\label{sec:SafetyProp}

\section{Analysis specification} %specifica dell'analisi
\label{sec:AnalysisSpec}

\[
\begin{array}{llcl}
\mathit{Abstract\ cache} & \Cat & : & \labs \rightarrow \absvalues \\
\mathit{Abstract\ variable\ environment} & \Env & : & \vars \rightarrow \absvalues \\
\mathit{Abstract\ memory} & \absmem & : & \labs \times \perms \rightarrow \absvalues \\
\mathit{Abstract\ permission\ cache} & \Pat & : & \labs \rightarrow \perms \\
\end{array}
\]
\begin{tabular}{l l l l}
{[\textit{PE-Val}]}&\multicolumn{3}{l}{$\aenvs \modelrho c : \vat$ iff $\{d_c\} \subseteq \vat$} \\
{[\textit{PE-Var}]}&\multicolumn{3}{l}{$\aenvs \modelrho x : \vat$ iff $\Env(x) \subseteq \vat$} \\ 
{[\textit{PE-Lambda}]}&\multicolumn{3}{l}{$\aenvs \modelrho \lam{x}{e} : \vat$ iff $\{\lam{x}{e}\} \subseteq \vat$} \\
{[\textit{PE-Obj}]}&\multicolumn{3}{l}{$\caest {\rec{\vec{str_i : e_i}}}$ iff} \\
&&\multicolumn{2}{l}{$\forall i: \caesti {e_i} {i} \wedge$}\\
&&&$\rec{\vec{str_i :\vat_i}} \subseteq \vat \wedge$ \\
&&&$\rho_i \sqsubseteq \rho$ \\ 
{[\textit{PE-Let}]}&\multicolumn{3}{l}{$\caest {\letexprs{x_i}{e_i}{e'}}$ iff}\\
&&\multicolumn{2}{l}{$\aenvs \modelrho e' : \vat \gg \rho' \wedge$} \\
&&\multicolumn{2}{l}{$\rho' \sqsubseteq \rho \wedge$} \\
&&\multicolumn{2}{l}{$ \forall i:$}\\
&&& $\caesti {e_i} {i} \wedge$ \\
&&& $\vat_i \subseteq \Env(x_i) \wedge$ \\
&&& $\rho_i \sqsubseteq \rho$ \\
{[\textit{PE-App}]}&\multicolumn{3}{l}{$\caest {\appl {e_1} {e_2}}$ iff} \\
&&\multicolumn{2}{l}{$\caesti {e_1} {1} \wedge$} \\
&&\multicolumn{2}{l}{$\caesti {e_2} {2} \wedge$} \\
&&\multicolumn{2}{l}{$\rho_1 \sqsubseteq \rho \wedge$} \\
&&\multicolumn{2}{l}{$\rho_2 \sqsubseteq \rho \wedge$} \\
&&\multicolumn{2}{l}{$\forall (\lam{x}{e_0}) \in \vat_1 :$}\\
&&&$\vat_2 \subseteq \Env(x) \wedge$\\
&&&$\caesti {e_0} {0} \wedge$\\ 
&&&$\rho_0 \sqsubseteq \rho \wedge$\\
&&&$\vat_0 \subseteq \vat $\\
{[\textit{PE-Op}]}&\multicolumn{3}{l}{$\caest {\op (\vec{e_i})} $ iff}\\
&&\multicolumn{2}{l}{$\forall i :$}\\
&&&$\caesti {e_i} {i} \wedge $\\
&&&$\rho_i \sqsubseteq \rho \wedge$\\
&&\multicolumn{2}{l}{$\widehat{op} (\vec{\vat_i}) \subseteq \vat $}\\
{[\textit{PE-Cond}]}&\multicolumn{3}{l}{$\caest {\cond {e_0} {e_1} {e_2}} $ iff}\\
&&\multicolumn{2}{l}{$\caesti {e_0} {0} \wedge$}\\
&&\multicolumn{2}{l}{$\rho_0 \sqsubseteq \rho \wedge$} \\
&&\multicolumn{2}{l}{$\widehat{\true} \in \vat_0 \Rightarrow$}\\
&&&$\caesti {e_1} {1} \wedge \vat_1 \subseteq \vat \wedge \rho_1 \sqsubseteq \rho \wedge$ \\
&&\multicolumn{2}{l}{$\widehat{\false} \in \vat_0 \Rightarrow$}\\
&&&$\caesti {e_2} {2} \wedge \vat_2 \subseteq \vat \wedge \rho_2 \sqsubseteq \rho$ \\
{[\textit{PE-While}]}&\multicolumn{3}{l}{$\caest {\while {e_1} {e_2}} $ iff}\\
&&\multicolumn{2}{l}{$\caesti {e_1} {1} \wedge $}\\
&&\multicolumn{2}{l}{$\rho_1 \sqsubseteq \rho \wedge$} \\
&&\multicolumn{2}{l}{$\widehat{\true} \in \vat_1 \Rightarrow$}\\
&&&$\caesti {e_2} {2} \wedge \vat_2 \subseteq \vat \wedge \rho_2 \sqsubseteq \rho \wedge$\\
&&\multicolumn{2}{l}{$\widehat{\false} \in \vat_1 \Rightarrow$}\\
&&&$\widehat{\undef} \subseteq \vat$\\
{[\textit{PE-GetField}]}&\multicolumn{3}{l}{$\caest {\lookup {e_1} {e_2}} $ iff}\\
&&\multicolumn{2}{l}{$ \caesti {e_1} {1} \wedge $}\\
&&\multicolumn{2}{l}{$\rho_1 \sqsubseteq \rho \wedge$} \\
&&\multicolumn{2}{l}{$ \caesti {e_2} {2} \wedge $} \\
&&\multicolumn{2}{l}{$\rho_2 \sqsubseteq \rho \wedge$} \\
&&\multicolumn{2}{l}{$\widehat{get} (\vat_1, \vat_2) \subseteq \vat$} \\
\end{tabular}\newpage
\begin{tabular} {l l l l}
{[\textit{PE-SetField}]}&\multicolumn{3}{l}{$\caest {\store {e_0} {e_1} {e2}} $ iff}\\
&&\multicolumn{2}{l}{$ \caesti {e_0} {0} \wedge $}\\
&&\multicolumn{2}{l}{$\rho_0 \sqsubseteq \rho \wedge$} \\
&&\multicolumn{2}{l}{$ \caesti {e_1} {1} \wedge $} \\
&&\multicolumn{2}{l}{$\rho_1 \sqsubseteq \rho \wedge$} \\
&&\multicolumn{2}{l}{$ \caesti {e_2} {2} \wedge $} \\
&&\multicolumn{2}{l}{$\rho_2 \sqsubseteq \rho \wedge$} \\
&&\multicolumn{2}{l}{$\widehat{set} (\vat_0, \vat_1, \vat_2) \subseteq \vat$} \\
{[\textit{PE-DelField}]}&\multicolumn{3}{l}{$\caest {\delete {e_1} {e_2}} $ iff}\\
&&\multicolumn{2}{l}{$ \caesti {e_1} {1} \wedge$}\\
&&\multicolumn{2}{l}{$\rho_1 \sqsubseteq \rho \wedge$} \\
&&\multicolumn{2}{l}{$ \caesti {e_2} {2} \wedge $} \\
&&\multicolumn{2}{l}{$\rho_2 \sqsubseteq \rho \wedge$} \\
&&\multicolumn{2}{l}{$\widehat{del} (\vat_1, \vat_2) \subseteq \vat$}\\
{[\textit{PE-Ref}]}&\multicolumn{3}{l}{$ \aenvs \modelrho \newref {r,\rho_r} {e} :\{r\} \gg \rho $ iff}\\
&&\multicolumn{2}{l}{$ \caest {e} \wedge $}\\
&&\multicolumn{2}{l}{$\rho_r \sqsubseteq \rho_s \Rightarrow \vat \subseteq \muat(r, \rho_r) $} \\
{[\textit{PE-DeRef}]}&\multicolumn{3}{l}{$\caest {\deref {e}} $ iff}\\
&&\multicolumn{2}{l}{$\caesti {e} {1} \wedge $}\\
&&\multicolumn{2}{l}{$\rho_1 \sqsubseteq \rho \wedge$ }\\
&&\multicolumn{2}{l}{$\forall r \in \vat_1 : \forall \rho_r \sqsubseteq \rho_s : \muat(r, \rho_r) \subseteq \vat$ }\\
{[\textit{PE-SetRef}]}&\multicolumn{3}{l}{$\caest {\setref {e_1} {e_2}} $ iff}\\
&&\multicolumn{2}{l}{$ \caesti {e} {1} \wedge $}\\
&&\multicolumn{2}{l}{$\rho_1 \sqsubseteq \rho \wedge$} \\
&&\multicolumn{2}{l}{$ \caesti {e_2} {2} \wedge $}\\
&&\multicolumn{2}{l}{$\rho_2 \sqsubseteq \rho \wedge$}\\
&&\multicolumn{2}{l}{$\forall r \in \vat_1 : \forall \rho_r \sqsubseteq \rho_s :$}\\
&&&$\vat_2 \subseteq \muat(r, \rho_r) \wedge$ \\
&&&$\vat_2 \subseteq \vat $\\
{[\textit{PE-Send}]}& \dots \\
{[\textit{PE-Err}]}& \dots \\
{[\textit{PE-Exercise}]}& \dots \\
\end{tabular}

\section{Compositional Verbose}
\begin{tabular}{l l l l}
{[\textit{CV-Val}]}&\multicolumn{3}{l}{$ \ccestl {c} $ iff $\{d_c\} \subseteq \Cat(\ell)$} \\ 
{[\textit{CV-Var}]}&\multicolumn{3}{l}{$ \ccestl {x} $ iff $\Env(x) \subseteq \Cat(\ell)$} \\ 
{[\textit{CV-Lambda}]}&\multicolumn{3}{l}{$ \ccestl {\lam{x}{\lbt 0}} $ iff}\\
&&\multicolumn{2}{l}{$\{\lam{x}{\lbt 0}\} \subseteq \Cat(\ell) \wedge $}\\
&&\multicolumn{2}{l}{$ \ccest {\lbt 0}$}\\
{[\textit{CV-Obj}]}&\multicolumn{3}{l}{$ \ccestl {\rec{\vec{str_i : \lbt i}}}$ iff}\\
&&\multicolumn{2}{l}{$\forall i:$}\\
&&&$\ccest {\lbt i} \wedge$\\
&&&$\Pat(\ell_i) \sqsubseteq \Pat(\ell) \wedge$\\ 
&&\multicolumn{2}{l}{$\rec{\vec{str_i : \Cat(\ell_i)}} \subseteq \Cat_\ell $} \\
{[\textit{CV-Let}]}&\multicolumn{3}{l}{$ \ccestl {\letexprs{x_i}{\lbt i}{{e'}^{\ell'}}}$ iff}\\
&&\multicolumn{2}{l}{$ \ccest {{e'}^{\ell'}} \wedge$} \\
&&\multicolumn{2}{l}{$ \Pat(\ell') \sqsubseteq \Pat(\ell) \wedge$}\\
&&\multicolumn{2}{l}{$ \Cat(\ell') \subseteq \Cat(\ell) \wedge$}\\
&&\multicolumn{2}{l}{$ \forall i:$}\\
&&&$\ccest {{e_i}^{\ell_i}} \wedge$ \\
&&& $ \Cat(\ell_i) \subseteq \Env(x_i) \wedge$ \\
&&& $ \Pat(\ell_i) \sqsubseteq \Pat(\ell) $ \\
{[\textit{CV-App}]}&\multicolumn{3}{l}{$ \ccestl {\appl {\lbt 1} {\lbt 2}}$ iff}\\
&&\multicolumn{2}{l}{$\ccest {\lbt 1} \wedge \ccest {\lbt 2} \wedge$} \\
&&\multicolumn{2}{l}{$\Pat(\ell_1) \sqsubseteq \Pat(\ell) \wedge \Pat(\ell_2) \sqsubseteq \Pat(\ell)$} \\
&&\multicolumn{2}{l}{$\forall (\lam{x}{\lbt 0}) \in \Cat(\ell_1) :$}\\
&&&$\Cat(\ell_2) \subseteq \Env(x) \wedge \Cat(\ell_0) \subseteq \Cat(\ell) \wedge$\\
&&&$\Pat(\ell_0) \sqsubseteq \Pat(\ell) $\\
{[\textit{CV-Op}]}&\multicolumn{3}{l}{$ \ccestl {\op (\vec{\lbt i})} $ iff}\\
&&\multicolumn{2}{l}{$\forall i :$}\\
&&&$\ccest {\lbt i} \wedge $\\
&&&$\Pat(\ell_i) \sqsubseteq \Pat(\ell) \wedge$\\
&&\multicolumn{2}{l}{$\widehat{op} (\Cat(\ell_i)) \subseteq \Cat(\ell) $}\\
{[\textit{CV-Cond}]}&\multicolumn{3}{l}{$\ccestl{\cond {\lbt 0} {\lbt 1} {\lbt 2}} $ iff}\\
&&\multicolumn{2}{l}{$ \ccest {\lbt 0} \wedge $}\\
&&\multicolumn{2}{l}{$\Pat(\ell_0) \sqsubseteq \Pat(\ell) \wedge$} \\
&&\multicolumn{2}{l}{$\widehat{\true} \in \Cat(\ell_0) \Rightarrow$}\\
&&&$\ccest {\lbt 1} \wedge \Cat(\ell_1) \subseteq \Cat(\ell)\wedge$\\
&&&$\Pat(\ell_1) \sqsubseteq \Pat(\ell) \wedge$ \\
&&\multicolumn{2}{l}{$\widehat{\false} \in \Cat(\ell_0) \Rightarrow$}\\
&&&$\ccest {\lbt 2} \wedge \Cat(\ell_2) \subseteq \Cat(\ell) \wedge$\\
&&&$\Pat(\ell_2) \sqsubseteq \Pat(\ell)$ \\
{[\textit{CV-While}]}&\multicolumn{3}{l}{$\ccestl {\while {\lbt 1} {\lbt 2}} $ iff}\\
&&\multicolumn{2}{l}{$ \ccest {\lbt 1} \wedge $}\\
&&\multicolumn{2}{l}{$\Pat(\ell_1) \sqsubseteq \Pat(\ell) \wedge$} \\
&&\multicolumn{2}{l}{$\widehat{\true} \in \Cat(\ell_1) \Rightarrow$}\\
&&&$\ccest {\lbt 2} \wedge \Cat(\ell_2) \subseteq \Cat(\ell) \wedge$\\
&&&$ \Pat(\ell_2) \sqsubseteq \Pat(\ell) \wedge$\\
&&\multicolumn{2}{l}{$\widehat{\false} \in \Cat(\ell_1) \Rightarrow \widehat{\undef} \subseteq \Cat(\ell)$}\\
\end{tabular}

\begin{tabular} {l l l l}
{[\textit{CV-GetField}]}&\multicolumn{3}{l}{$\ccestl {\lookup {\lbt 1} {\lbt 2}} $ iff}\\
&&\multicolumn{2}{l}{$ \ccest {\lbt1} \wedge $}\\
&&\multicolumn{2}{l}{$\Pat(\ell_1) \sqsubseteq \Pat(\ell) \wedge$} \\
&&\multicolumn{2}{l}{$ \ccest {\lbt 2} \wedge $} \\
&&\multicolumn{2}{l}{$\Pat(\ell_2) \sqsubseteq \Pat(\ell) \wedge$} \\
&&\multicolumn{2}{l}{$\widehat{get} (\Cat(\ell_1), \Cat(\ell_2)) \subseteq \Cat(\ell)$} \\
{[\textit{CV-SetField}]}&\multicolumn{3}{l}{$\ccestl {\store {\lbt 0} {\lbt 1} {\lbt 2}} $ iff}\\
&&\multicolumn{2}{l}{$ \ccest {\lbt 0} \wedge $}\\
&&\multicolumn{2}{l}{$\Pat(\ell_0) \sqsubseteq \Pat(\ell) \wedge$} \\
&&\multicolumn{2}{l}{$ \ccest {\lbt 1} \wedge $} \\
&&\multicolumn{2}{l}{$\Pat(\ell_1) \sqsubseteq \Pat(\ell) \wedge$} \\
&&\multicolumn{2}{l}{$ \ccest {\lbt 2} \wedge $} \\
&&\multicolumn{2}{l}{$\Pat(\ell_2) \sqsubseteq \Pat(\ell) \wedge$} \\
&&\multicolumn{2}{l}{$\widehat{set} (\Cat(\ell_0), \Cat(\ell_1), \Cat(\ell_2)) \subseteq \Cat(\ell)$} \\
{[\textit{CV-DelField}]}&\multicolumn{3}{l}{$\ccestl {\delete {\lbt 1} {\lbt 2}} $ iff}\\ 
&&\multicolumn{2}{l}{$ \ccest {\lbt 1} \wedge $}\\
&&\multicolumn{2}{l}{$\Pat(\ell_1) \sqsubseteq \Pat(\ell) \wedge$} \\
&&\multicolumn{2}{l}{$ \ccest {\lbt 2} \wedge $} \\
&&\multicolumn{2}{l}{$\Pat(\ell_2) \sqsubseteq \Pat(\ell) \wedge$} \\
&&\multicolumn{2}{l}{$\widehat{del} (\Cat(\ell_1), \Cat(\ell_2)) \subseteq \Cat(\ell)$}\\
{[\textit{CV-Ref}]}&\multicolumn{3}{l}{$ \ccestl {\newref {r,\rho_r} {\lbt 1}} $ iff}\\
&&\multicolumn{2}{l}{$\ccest {\lbt 1} \wedge $}\\
&&\multicolumn{2}{l}{$\{r\} \subseteq \Cat(\ell) \wedge$}\\
&&\multicolumn{2}{l}{$\Pat(\ell_1) \sqsubseteq \Pat(\ell) \wedge$}\\
&&\multicolumn{2}{l}{$\rho_r \sqsubseteq \rho_s \Rightarrow \Cat(\ell_1) \subseteq \muat(r, \rho_r) $}\\
{[\textit{CV-DeRef}]}&\multicolumn{3}{l}{$\ccestl {\deref {\lbt 1}} $ iff}\\
&&\multicolumn{2}{l}{$ \ccest {\lbt 1}\wedge $}\\
&&\multicolumn{2}{l}{$\Pat(\ell_1) \sqsubseteq \Pat(\ell) \wedge$}\\
&&\multicolumn{2}{l}{$\forall r \in \Cat(\ell_1) : \forall \rho_r \sqsubseteq \rho_s :$}\\
&&&$\muat(r, \rho_r) \subseteq \Cat(\ell)$ \\
{[\textit{CV-SetRef}]}&\multicolumn{3}{l}{$\ccestl {\setref {\lbt 1} {\lbt 2}} $ iff}\\
&&\multicolumn{2}{l}{$ \ccest {\lbt 1} \wedge $}\\
&&\multicolumn{2}{l}{$ \Pat(\ell_1) \sqsubseteq \Pat(\ell) \wedge $}\\
&&\multicolumn{2}{l}{$ \ccest {\lbt 2} \wedge $}\\
&&\multicolumn{2}{l}{$ \Pat(\ell_2) \sqsubseteq \Pat(\ell) \wedge $}\\
&&\multicolumn{2}{l}{$ \forall r \in \Cat(\ell_1) : \forall \rho_r \sqsubseteq \rho_s :$}\\
&&&$\Cat(\ell_2) \subseteq \muat(r, \rho_r) \wedge$ \\
&&\multicolumn{2}{l}{$\Cat(\ell_2) \subseteq \Cat(\ell) $} \\
{[\textit{PE-Send}]}& \dots \\
{[\textit{PE-Err}]}& \dots \\
{[\textit{PE-Exercise}]}& \dots \\
\end{tabular}

\section{Theorem} % teorema (senza dimostrazione)
\label{sec:Theorem}

\section{Requirements for correctness} % condizioni necessarie per correttezza
\label{sec:CorrectnesReqs}